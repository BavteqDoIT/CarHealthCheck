<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head}">
    <title>Car Health Check</title>
</head>
<body>
<div th:replace="~{layout :: navbar}"></div>
<div class="container py-4">
    <main>
        <h1 class="display-4 text-center mb-4" th:text="#{summary.title}"></h1>
        <div th:object="${car}">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <div class="alert alert-info p-4 rounded-3 shadow-sm">
                <h3 class="mb-3 text-center" th:text="#{summary.table.car.title}">Car details</h3>
                <table class="table table-striped table-bordered align-middle">
                    <tbody>
                    <tr>
                        <th scope="row" th:text="#{summary.brand}">Brand</th>
                        <td th:text="*{brand.brandName}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.model}">Model</th>
                        <td th:text="*{modelType.modelName}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.color}">Color</th>
                        <td th:text="#{*{color.color}}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.engine}">Engine</th>
                        <td th:text="*{engineType.name}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.body.type}">Body type</th>
                        <td th:text="*{bodyType.bodyType}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.drive.type}">Drive type</th>
                        <td th:text="#{*{driveType.driveType}}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.gearbox}">Gearbox</th>
                        <td th:text="#{*{gearboxType.gearboxType}}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.production.year}">Production year</th>
                        <td th:text="*{productionYear}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.mileage}">Mileage</th>
                        <td th:text="*{mileage + ' km'}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.vin}">VIN</th>
                        <td th:text="*{vin}"></td>
                    </tr>
                    <tr th:if="${car.firstRegistrationDate != null}">
                        <th scope="row" th:text="#{summary.first.registration}">Date of first registration in Poland
                        </th>
                        <td th:text="*{firstRegistrationDate}"></td>
                    </tr>
                    <tr th:if="${car.foreignRegistered == true}">
                        <th scope="row" th:text="#{summary.model.foreign.registered}">Foreign registered</th>
                        <td>
                            <span th:text="*{foreignRegistered} ? #{summary.yes} : #{summary.no}"></span>
                        </td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.car.name}">Car name</th>
                        <td th:text="*{name}"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.car.score}"></th>
                        <td th:text="${summary.basicScoreUsed}+ '/100'"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.risk.score}"></th>
                        <td th:text="${summary.finalScore}+ '/100'"></td>
                    </tr>
                    <tr>
                        <th scope="row" th:text="#{summary.risk.level}"></th>
                        <td th:text="${summary.riskLevel}"></td>
                    </tr>
<!--                    <tr>-->
<!--                        <th scope="row" th:text="#{summary.risk.reasons}"></th>-->
<!--                        <td th:text="${summary.riskReasons}"></td>-->
<!--                    </tr>-->
                    </tbody>
                </table>
                <div class="mt-3">


                    <div th:if="${summary.redFlags.size() > 0}" class="alert alert-danger">
                        <b th:block th:text="#{summary.redFlags.title}"/>
                        <ul>
                            <li th:each="msg : ${summary.redFlags}" th:text="${msg}"></li>
                        </ul>
                    </div>
                    <div th:if="${summary.yellowFlags.size() > 0}" class="alert alert-warning">
                        <b th:block th:text="#{summary.yellowFlags.title}"/>
                        <ul>
                            <li th:each="msg : ${summary.yellowFlags}" th:text="${msg}"></li>
                        </ul>
                        <div th:if="${summary.paintDamageDetails != null and summary.paintDamageDetails.size() > 0}" class="mt-2">
                            <button type="button" class="btn btn-outline-dark btn-sm"
                                    data-bs-toggle="modal" data-bs-target="#paintDamageModal"
                                    th:text="#{summary.details}">
                                Zobacz szczegóły
                            </button>
                        </div>
                        <div class="modal fade" id="paintDamageModal" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-lg modal-dialog-scrollable">
                                <div class="modal-content">

                                    <div class="modal-header">
                                        <h5 class="modal-title" th:text="#{summary.paint.damage.modal.title}">Uszkodzenia lakieru</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>

                                    <div class="modal-body">
                                        <ul class="list-group">
                                            <li class="list-group-item"
                                                th:each="d : ${summary.paintDamageDetails}"
                                                th:text="${d}"></li>
                                        </ul>
                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                                                th:text="#{summary.close}">Zamknij</button>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div th:if="${summary.greenNotes.size() > 0}" class="alert alert-success">
                        <b th:block th:text="#{summary.greenFlags.title}"/>
                        <ul>
                            <li th:each="msg : ${summary.greenNotes}" th:text="${msg}"></li>
                        </ul>
                    </div>

                </div>
                <div class="d-flex justify-content-center gap-3 mt-4">
                    <div>
                        <a href="/account" class="btn btn-success btn-lg">
                            <span th:text="#{summary.confirmation.button}"></span>
                        </a>
                    </div>
                    <div th:insert="~{fragments/cancelButton.html}"></div>
                </div>
            </div>
        </div>
    </main>
</div>
<div th:replace="~{layout :: footer}"></div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</body>
</html>
