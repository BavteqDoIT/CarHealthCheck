<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{layout :: head}">
    <title>Car Health Check</title>
</head>
<body>
<div th:replace="~{layout :: navbar}"></div>

<div class="container py-4">
    <main>
        <form method="POST" th:action="@{/design/questions/save}">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <input type="hidden" name="carId" th:value="${carId}"/>
            <input type="hidden" name="category" th:value="${category}"/>

            <div class="row g-3 mt-3">
                <div th:each="q : ${questions}" class="col-md-6">
                    <div class="p-3 border rounded-3 bg-light-subtle h-100">

                        <div th:switch="${q.questionType}">

                            <div th:case="'select'">
                                <div class="d-flex align-items-start justify-content-between gap-3 mb-2">
                                    <label class="m-0 flex-grow-1" th:for="|select-${q.id}|">
                                        <span class="me-2" th:switch="${q.subCategory}">
                                            <span th:case="'exterior'">üöó</span>
                                            <span th:case="'tires'">‚≠ïÔ∏è</span>
                                            <span th:case="'fluids'">üõ¢Ô∏è</span>
                                            <span th:case="'docs'">üìÑ</span>
                                            <span th:case="'trim'">ü™ë</span>
                                            <span th:case="'electronics'">üí°</span>
                                            <span th:case="'startup'">üö¶Ô∏è</span>
                                            <span th:case="'engine'">‚öôÔ∏è</span>
                                            <span th:case="'drivetrain'">üî©Ô∏è</span>
                                            <span th:case="'roadtest'">üõ£Ô∏è</span>
                                            <span th:case="*">‚ùì</span>
                                        </span>
                                        <span class="fw-semibold" th:text="#{${q.questionKey}}"></span>
                                    </label>

                                    <div sec:authorize="hasRole('ADMIN')" class="flex-shrink-0">
                                        <div class="input-group input-group-sm" style="width: 140px;">
                                            <span class="input-group-text" th:text="#{questions.weight}"></span>
                                            <input type="number"
                                                   min="1"
                                                   max="999"
                                                   class="form-control text-center"
                                                   th:name="|weight_${q.id}|"
                                                   th:value="${q.weight}"/>
                                        </div>
                                    </div>
                                </div>

                                <select th:id="|select-${q.id}|"
                                        class="form-select"
                                        th:name="|selectedOption_${q.id}|">
                                    <option th:each="opt : ${q.options}"
                                            th:value="${opt.id}"
                                            th:text="#{${opt.labelKey}}"></option>
                                </select>
                            </div>

                            <div th:case="'text'">
                                <div class="d-flex align-items-start justify-content-between gap-3 mb-2">
                                    <label class="m-0 flex-grow-1" th:for="|text-${q.id}|">
                                        <span class="me-2" th:switch="${q.subCategory}">
                                            <span th:case="'brakes'">üõë</span>
                                            <span th:case="'oil'">üõ¢Ô∏è</span>
                                            <span th:case="'wheels'">‚≠ï</span>
                                            <span th:case="'seats'">üí∫</span>
                                            <span th:case="'dashboard'">üí°</span>
                                            <span th:case="'engine'">‚öôÔ∏è</span>
                                            <span th:case="'suspension'">‚öôÔ∏è</span>
                                            <span th:case="*">‚ùì</span>
                                        </span>
                                        <span class="fw-semibold" th:text="#{${q.questionKey}}"></span>
                                    </label>

                                    <div sec:authorize="hasRole('ADMIN')" class="flex-shrink-0">
                                        <div class="input-group input-group-sm" style="width: 140px;">
                                            <span class="input-group-text">Waga</span>
                                            <input type="number"
                                                   min="1"
                                                   max="999"
                                                   class="form-control text-center"
                                                   th:name="|weight_${q.id}|"
                                                   th:value="${q.weight}"/>
                                        </div>
                                    </div>
                                </div>

                                <input th:id="|text-${q.id}|"
                                       type="text"
                                       th:name="|answerValue_${q.id}|"
                                       th:placeholder="#{questions.placeholder.text}"
                                       class="form-control"/>
                            </div>

                            <div th:case="'number'">
                                <div class="d-flex align-items-start justify-content-between gap-3 mb-2">
                                    <label class="m-0 flex-grow-1" th:for="|number-${q.id}|">
                                        <span class="me-2" th:switch="${q.subCategory}">
                                            <span th:case="'brakes'">üõë</span>
                                            <span th:case="'oil'">üõ¢Ô∏è</span>
                                            <span th:case="'wheels'">‚≠ï</span>
                                            <span th:case="'seats'">üí∫</span>
                                            <span th:case="'dashboard'">üí°</span>
                                            <span th:case="'engine'">‚öôÔ∏è</span>
                                            <span th:case="'suspension'">‚öôÔ∏è</span>
                                            <span th:case="*">‚ùì</span>
                                        </span>
                                        <span class="fw-semibold" th:text="#{${q.questionKey}}"></span>
                                    </label>

                                    <div sec:authorize="hasRole('ADMIN')" class="flex-shrink-0">
                                        <div class="input-group input-group-sm" style="width: 140px;">
                                            <span class="input-group-text">Waga</span>
                                            <input type="number"
                                                   min="1"
                                                   max="999"
                                                   class="form-control text-center"
                                                   th:name="|weight_${q.id}|"
                                                   th:value="${q.weight}"/>
                                        </div>
                                    </div>
                                </div>

                                <input th:id="|number-${q.id}|"
                                       type="number"
                                       th:name="|numericValue_${q.id}|"
                                       th:placeholder="#{questions.placeholder.number}"
                                       class="form-control"/>
                            </div>

                        </div>

                        <input type="hidden" th:name="|questionId_${q.id}|" th:value="${q.id}"/>
                    </div>
                </div>
            </div>

            <div class="mt-5 mb-4 text-center">
                <button type="submit" class="btn btn-primary btn-lg px-4 py-2 rounded-pill shadow-sm"
                        th:text="#{design.button}"></button>
                <div th:insert="~{fragments/cancelButton.html}" class="d-inline-block"></div>
            </div>
        </form>
    </main>
</div>

<div th:replace="~{layout :: footer}"></div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</body>
</html>
